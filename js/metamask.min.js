var global_Second=30,contractAddr="0x4e71b5e47a7e4f8eaccff4ade0e3292f80780cf0",contractAbi=[{constant:!0,inputs:[],name:"getBuyPrice",outputs:[{name:"",type:"uint256"}],payable:!(window.xyj={}),stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_affCode",type:"bytes32"},{name:"_team",type:"uint256"},{name:"_eth",type:"uint256"}],name:"reLoadXname",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"activate",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"pIDxAddr_",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"airDropTracker_",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"round_",outputs:[{name:"plyr",type:"uint256"},{name:"team",type:"uint256"},{name:"end",type:"uint256"},{name:"ended",type:"bool"},{name:"strt",type:"uint256"},{name:"keys",type:"uint256"},{name:"eth",type:"uint256"},{name:"pot",type:"uint256"},{name:"mask",type:"uint256"},{name:"ico",type:"uint256"},{name:"icoGen",type:"uint256"},{name:"icoAvg",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"},{name:"",type:"bytes32"}],name:"plyrNames_",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"fees_",outputs:[{name:"gen",type:"uint256"},{name:"p3d",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"bytes32"}],name:"pIDxName_",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_affCode",type:"uint256"},{name:"_team",type:"uint256"},{name:"_eth",type:"uint256"}],name:"reLoadXid",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"withdraw",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_nameString",type:"string"},{name:"_affCode",type:"address"},{name:"_all",type:"bool"}],name:"registerNameXaddr",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[{name:"_pID",type:"uint256"},{name:"_addr",type:"address"},{name:"_name",type:"bytes32"},{name:"_laff",type:"uint256"}],name:"receivePlayerInfo",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"},{name:"",type:"uint256"}],name:"rndTmEth_",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"rID_",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_pID",type:"uint256"}],name:"getPlayerVaults",outputs:[{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_nameString",type:"string"},{name:"_affCode",type:"bytes32"},{name:"_all",type:"bool"}],name:"registerNameXname",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"getCurrentRoundInfo",outputs:[{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"address"},{name:"",type:"bytes32"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_affCode",type:"address"},{name:"_team",type:"uint256"},{name:"_eth",type:"uint256"}],name:"reLoadXaddr",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_affCode",type:"uint256"},{name:"_team",type:"uint256"}],name:"buyXid",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!1,inputs:[{name:"_pID",type:"uint256"},{name:"_name",type:"bytes32"}],name:"receivePlayerNameList",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_nameString",type:"string"},{name:"_affCode",type:"uint256"},{name:"_all",type:"bool"}],name:"registerNameXID",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_affCode",type:"address"},{name:"_team",type:"uint256"}],name:"buyXaddr",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"},{name:"",type:"uint256"}],name:"plyrRnds_",outputs:[{name:"eth",type:"uint256"},{name:"keys",type:"uint256"},{name:"mask",type:"uint256"},{name:"ico",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_affCode",type:"bytes32"},{name:"_team",type:"uint256"}],name:"buyXname",outputs:[],payable:!0,stateMutability:"payable",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"potSplit_",outputs:[{name:"gen",type:"uint256"},{name:"p3d",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getTimeLeft",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_rID",type:"uint256"},{name:"_eth",type:"uint256"}],name:"calcKeysReceived",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_keys",type:"uint256"}],name:"iWantXKeys",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"activated_",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"airDropPot_",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"plyr_",outputs:[{name:"addr",type:"address"},{name:"name",type:"bytes32"},{name:"win",type:"uint256"},{name:"gen",type:"uint256"},{name:"aff",type:"uint256"},{name:"lrnd",type:"uint256"},{name:"laff",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_addr",type:"address"}],name:"getPlayerInfoByAddress",outputs:[{name:"",type:"uint256"},{name:"",type:"bytes32"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"playerID",type:"uint256"},{indexed:!0,name:"playerAddress",type:"address"},{indexed:!0,name:"playerName",type:"bytes32"},{indexed:!1,name:"isNewPlayer",type:"bool"},{indexed:!1,name:"affiliateID",type:"uint256"},{indexed:!1,name:"affiliateAddress",type:"address"},{indexed:!1,name:"affiliateName",type:"bytes32"},{indexed:!1,name:"amountPaid",type:"uint256"},{indexed:!1,name:"timeStamp",type:"uint256"}],name:"onNewName",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"compressedData",type:"uint256"},{indexed:!1,name:"compressedIDs",type:"uint256"},{indexed:!1,name:"playerName",type:"bytes32"},{indexed:!1,name:"playerAddress",type:"address"},{indexed:!1,name:"ethIn",type:"uint256"},{indexed:!1,name:"keysBought",type:"uint256"},{indexed:!1,name:"winnerAddr",type:"address"},{indexed:!1,name:"winnerName",type:"bytes32"},{indexed:!1,name:"amountWon",type:"uint256"},{indexed:!1,name:"newPot",type:"uint256"},{indexed:!1,name:"P3DAmount",type:"uint256"},{indexed:!1,name:"genAmount",type:"uint256"},{indexed:!1,name:"potAmount",type:"uint256"},{indexed:!1,name:"airDropPot",type:"uint256"}],name:"onEndTx",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"playerID",type:"uint256"},{indexed:!1,name:"playerAddress",type:"address"},{indexed:!1,name:"playerName",type:"bytes32"},{indexed:!1,name:"ethOut",type:"uint256"},{indexed:!1,name:"timeStamp",type:"uint256"}],name:"onWithdraw",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"playerAddress",type:"address"},{indexed:!1,name:"playerName",type:"bytes32"},{indexed:!1,name:"ethOut",type:"uint256"},{indexed:!1,name:"compressedData",type:"uint256"},{indexed:!1,name:"compressedIDs",type:"uint256"},{indexed:!1,name:"winnerAddr",type:"address"},{indexed:!1,name:"winnerName",type:"bytes32"},{indexed:!1,name:"amountWon",type:"uint256"},{indexed:!1,name:"newPot",type:"uint256"},{indexed:!1,name:"P3DAmount",type:"uint256"},{indexed:!1,name:"genAmount",type:"uint256"}],name:"onWithdrawAndDistribute",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"playerAddress",type:"address"},{indexed:!1,name:"playerName",type:"bytes32"},{indexed:!1,name:"ethIn",type:"uint256"},{indexed:!1,name:"compressedData",type:"uint256"},{indexed:!1,name:"compressedIDs",type:"uint256"},{indexed:!1,name:"winnerAddr",type:"address"},{indexed:!1,name:"winnerName",type:"bytes32"},{indexed:!1,name:"amountWon",type:"uint256"},{indexed:!1,name:"newPot",type:"uint256"},{indexed:!1,name:"P3DAmount",type:"uint256"},{indexed:!1,name:"genAmount",type:"uint256"}],name:"onBuyAndDistribute",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"playerAddress",type:"address"},{indexed:!1,name:"playerName",type:"bytes32"},{indexed:!1,name:"compressedData",type:"uint256"},{indexed:!1,name:"compressedIDs",type:"uint256"},{indexed:!1,name:"winnerAddr",type:"address"},{indexed:!1,name:"winnerName",type:"bytes32"},{indexed:!1,name:"amountWon",type:"uint256"},{indexed:!1,name:"newPot",type:"uint256"},{indexed:!1,name:"P3DAmount",type:"uint256"},{indexed:!1,name:"genAmount",type:"uint256"}],name:"onReLoadAndDistribute",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"affiliateID",type:"uint256"},{indexed:!1,name:"affiliateAddress",type:"address"},{indexed:!1,name:"affiliateName",type:"bytes32"},{indexed:!0,name:"roundID",type:"uint256"},{indexed:!0,name:"buyerID",type:"uint256"},{indexed:!1,name:"amount",type:"uint256"},{indexed:!1,name:"timeStamp",type:"uint256"}],name:"onAffiliatePayout",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"roundID",type:"uint256"},{indexed:!1,name:"amountAddedToPot",type:"uint256"}],name:"onPotSwapDeposit",type:"event"}];"undefined"==typeof web3&&(web3=new Web3(new Web3.providers.HttpProvider("https://mainnet.infura.io/WlvljmHqo75RhK1w1QJF")));var contractNet=web3.eth.contract(contractAbi).at(contractAddr);console.log(contractNet),xyj.getAccounts=function(n){if("function"!=typeof n)return"need async function !.";web3.eth.getAccounts(function(e,t){e?n("getAccounts err",null):t?n(null,t.toString()):n(e,null)})},xyj.getGasPrice=function(n){if("function"!=typeof n)return"need async function !.";web3.eth.getGasPrice(function(e,t){e?n(new Error("getGasPrice error"),null):t?n(null,t.toNumber(10)):n(e,null)})},xyj.getTimeLeft=function(n){if("function"!=typeof n)return"need async function !.";contractNet?contractNet.getTimeLeft(function(e,t){e?n(e,null):t&&n(null,t.toNumber(10))}):n("contractNet error at getTimeLeft",null)},xyj.getPlayerInfoByAddress=function(e,n){return"string"!=typeof e?"need string addr !.":"function"!=typeof n?"need async function !.":void(contractNet?contractNet.getPlayerInfoByAddress(e,function(e,t){e?n("getPlayerInfoByAddress error",null):t&&n(null,{id:t[0].toString(),inviteName:web3.toUtf8(t[1]),keys:Math.ceil(t[2].toNumber()/Math.pow(10,18)),earn:web3.fromWei(t[4].toNumber()),totalEarn:web3.fromWei(t[5].toNumber()+t[3].toNumber()+t[4].toNumber()),shareEarn:web3.fromWei(t[5].toNumber()),payMoney:web3.fromWei(t[6].toNumber()),winningValue_3:web3.fromWei(t[3].toNumber()),winningValue_4:web3.fromWei(t[4].toNumber())})}):n("contractNet error at getPlayerInfoByAddress",null))},xyj.getCurrentRoundInfo=function(n){if("function"!=typeof n)return"need async function !.";contractNet?contractNet.getCurrentRoundInfo(function(e,t){e?n("getCurrentRoundInfo error",null):t&&n(null,{roundNum:t[1].toNumber(),totalKey:Math.ceil(t[2].toNumber()/Math.pow(10,18)),currPot:web3.fromWei(t[5].toNumber()),startedTime:t[4].toNumber(),endedTime:t[3].toNumber(),whales_0:web3.fromWei(t[9].toNumber()),bears_1:web3.fromWei(t[10].toNumber()),sneks_2:web3.fromWei(t[11].toNumber()),bulls_3:web3.fromWei(t[12].toNumber()),purchasedSeconds:Math.ceil(t[2].toNumber()/Math.pow(10,18))*global_Second,purchasedTime:Math.ceil(t[2].toNumber()/Math.pow(10,18))*global_Second/31536e3,lastBuyAddr:t[7].toString(),lastBuyName:web3.toUtf8(t[8])})}):n("contractNet error at getCurrentRoundInfo",null)},xyj.getBuyPrice=function(a){if("function"!=typeof a)return"need async function !.";contractNet.getBuyPrice(function(e,t){if(e)a("getBuyPrice error",null);else if(t){var n=t.toNumber(10);a(null,n/Math.pow(10,18))}})},xyj.iWantXKeys=function(e,n){if("number"!=typeof e)return"keyNum need number";contractNet?contractNet.iWantXKeys(web3.toWei(parseFloat(e)),function(e,t){e?n(e,null):t&&n(null,web3.fromWei(t.toNumber()))}):n("contractNet error at registerNameXaddr",null)},xyj.withdraw=function(n){if("function"!=typeof n)return"need async function !.";contractNet.withdraw(function(e,t){e?n("withdraw error",null):t&&n(null,!0)})},xyj.registerNameXname=function(e,t,n){return"string"!=typeof e?"need string regName !.":"string"!=typeof t?"need string _affCode name !.":"function"!=typeof n?"need async function !.":void(contractNet?contractNet.registerNameXname(e.toString(),t,!0,{value:web3.toWei("0.01","ether")},function(e,t){e?n(e,null):t&&n(null,!0)}):n("contractNet error at registerNameXname",null))},xyj.registerNameXaddr=function(e,t,n){return"string"!=typeof e?"need string regName !.":"string"!=typeof t?"need string _affCode addr !.":"function"!=typeof n?"need async function !.":void(contractNet?contractNet.registerNameXaddr(e.toString(),t,!0,{value:web3.toWei("0.01","ether")},function(e,t){e?n(e,null):t&&n(null,!0)}):n("contractNet error at registerNameXaddr",null))},xyj.registerNameXID=function(e,t,n){return"string"!=typeof e?"need string regName !.":"number"!=typeof t?"need number _affCode id !.":"function"!=typeof n?"need async function !.":void(contractNet?contractNet.registerNameXID(e.toString(),t,!0,{value:web3.toWei("0.01","ether")},function(e,t){e?n(e,null):t&&n(null,!0)}):n("contractNet error at registerNameXname",null))},xyj.getRound=function(a){contractNet?this.getCurrentRoundInfo(function(e,t){t&&contractNet.round_(parseFloat(t.roundNum),function(e,t){if(e)a(e,null);else if(t){var n=null;n=t[6].toNumber()-t[7].toNumber()<0?{totalEth:web3.fromWei(t[6].toNumber()),distributionEth:0,roundPot:web3.fromWei(t[7].toNumber())}:{totalEth:web3.fromWei(t[6].toNumber()),distributionEth:web3.fromWei(t[6].toNumber()-t[7].toNumber()),roundPot:web3.fromWei(t[7].toNumber())},a(null,n)}})}):a("contractNet error at getRound",null)},contractNet.allEvents(function(e,t){if(e)console.error("allEvents"+error);else if(t){var n="";if(t.args.playerName&&(n=web3.toUtf8(t.args.playerName)),window.refreshTime(),xyj._account&&window.refreshPersonInfo(),window.refreshInfo(),"onEndTx"===t.event){var a=Math.ceil(t.args.keysBought.toNumber()/Math.pow(10,18));xyj._account===t.args.playerAddress?alertify.success(1===a?_("您已成功购买{0}个金钻",a):_("您已成功购买{0}个金钻 ",a)):""!==n?alertify.success(1===a?_("{0}已成功购买{1}个金钻",n,a):_("{0}已成功购买{1}个金钻 ",n,a)):""===n&&alertify.success(1===a?_("有小伙伴已成功购买{0}个金钻",a):_("有小伙伴已成功购买{0}个金钻 ",a))}else if("onNewName"===t.event)""===n?alertify.success(_("有小伙伴已成功购买专属的推广代号")):alertify.success(_("全体起立，欢迎{0}成功购买专属的推广代号",n));else if("onWithdraw"===t.event||"onWithdrawAndDistribute"===t.event){var i=window.formatNum6(web3.fromWei(t.args.ethOut.toNumber()));xyj._account===t.args.playerAddress?alertify.success(_("您已成功提现{0}ETH!",i)):""===n?alertify.success(_("有小伙伴已成功提现{0}ETH!",i)):alertify.success(n+_("已成功提现{0}ETH!",i)),"onWithdrawAndDistribute"===t.event&&setTimeout(function(){alertify.success(_("请注意，新一轮的游戏准备开始"))},1e3)}else"onBuyAndDistribute"===t.event&&(xyj._account===t.args.playerAddress?alertify.alert(_("您已成功激活新一轮的游戏，激活游戏不会花费您的ETH，快来马上买钻取“金”吧")):alertify.success(_("请注意，新一轮的游戏准备开始")))}}),xyj.buyXaddr=function(e,t,n,a){return"string"!=typeof e?(a("_affCode param 1 need Sting ( addr )",null),"_affCode param 1 need Sting ( addr )"):"number"!=typeof t?(a("_team param 2 need number (0,1,2,3)",null),"_team param 2 need number (0,1,2,3)"):("string"==typeof n&&(n=parseFloat(n)),n?void contractNet.buyXaddr(e,parseInt(t),{value:web3.toWei(n,"ether")},function(e,t){e?a(e,null):t?a(null,t):a("buyXaddr error",null)}):(a("totalVal param 3 error",null),"totalVal param 3 error"))},xyj.buyXname=function(e,t,n,a){return"string"!=typeof e?(a("_affCode param 1 need Sting ( addr )",null),"_affCode param 1 need Sting ( addr )"):"number"!=typeof t?(a("_team param 2 need number (0,1,2,3)",null),"_team param 2 need number (0,1,2,3)"):("string"==typeof n&&(n=parseFloat(n)),n?void contractNet.buyXname(e,parseInt(t),{value:web3.toWei(n,"ether")},function(e,t){e?a(e,null):t?a(null,t):a("buyXname error",null)}):(a("totalVal param 3 error",null),"totalVal param 3 error"))},xyj.buyXid=function(e,t,n,a){return"number"!=typeof e?(a("_affCode param 1 need number ( id )",null),"_affCode param 1 need number ( id )"):"number"!=typeof t?(a("_team param 2 need number (0,1,2,3)",null),"_team param 2 need number (0,1,2,3)"):("string"==typeof n&&(n=parseFloat(n)),n?void contractNet.buyXid(e,parseInt(t),{value:web3.toWei(n,"ether")},function(e,t){e?a(e,null):t?a(null,t):a("buyXid error",null)}):(a("totalVal param 3 error",null),"totalVal param 3 error"))},xyj.reLoadXaddr=function(e,t,n,a){return"string"!=typeof e?(a("_affCode param 1 need Sting ( addr )",null),"_affCode param 1 need Sting ( addr )"):"number"!=typeof t?(a("_team param 2 need number (0,1,2,3)",null),"_team param 2 need number (0,1,2,3)"):("string"==typeof n&&(n=parseFloat(n)),void contractNet.reLoadXaddr(e,parseInt(t),web3.toWei(n,"ether"),function(e,t){e?a(e,null):t?a(null,t):a("reLoadXaddr error",null)}))},xyj.reLoadXname=function(e,t,n,a){return"string"!=typeof e?(a("_affCode param 1 need Sting ( addr )",null),"_affCode param 1 need Sting ( addr )"):"number"!=typeof t?(a("_team param 2 need number (0,1,2,3)",null),"_team param 2 need number (0,1,2,3)"):("string"==typeof n&&(n=parseFloat(n)),void contractNet.reLoadXname(e,parseInt(t),web3.toWei(n,"ether"),function(e,t){e?a(e,null):t?a(null,t):a("reLoadXname error",null)}))},xyj.reLoadXid=function(e,t,n,a){return"number"!=typeof e?(a("_affCode param 1 need number ( id )",null),"_affCode param 1 need number ( id )"):"number"!=typeof t?(a("_team param 2 need number (0,1,2,3)",null),"_team param 2 need number (0,1,2,3)"):("string"==typeof n&&(n=parseFloat(n)),void contractNet.reLoadXid(e,parseInt(t),web3.toWei(n,"ether"),function(e,t){e?a(e,null):t?a(null,t):a("reLoadXid error",null)}))};